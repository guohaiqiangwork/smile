<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>my_setting</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../css/font-awesome.min.css">
		<link rel="stylesheet" href="../css/mui.min.css">
		<link rel="stylesheet" href="../css/common.css">
		<link rel="stylesheet" href="../css/mobileReset.css">
		<link rel="stylesheet" href="../css/pages/myAddress.css" />
		<script src="../js/rem_reset.js"></script>
	</head>
	<body onselectstart="return false;">
		<header class="header_white">
			<i class="mui-action-back"><img src="../image/left@2x.png"></i>
			收货地址
		</header>
		<div class="contentA">
			<div id="myAddress">
				<!-- 暂无地址 -->
				<!-- <div class="address_moduel">
					<div class="_left">
						<div class="_one">
							<span style="color: #5A5A5A;">刘一手</span>
							<span>188****1357</span>
							<span class="_falge">默认</span>
						</div>
						<div class="_two">
							内蒙古自治区 包头市 昆都仑区 友谊大街18栋2号
							西门左转
						</div>
						
					</div>
					<div class="_three"></div>
					<div class="_right">
						编辑
					</div>
				</div>
 -->
			</div>
			<div class="bottom_btn">
				添加新地址
			</div>
		</div>
	</body>
	<script src="../js/jquery-1.11.2.min.js"></script>
	<script src="../js/mui.min.js"></script>
	<script src="../js/commonFun.js"></script>
	<script src="../js/requestFun.js"></script>
	<script>
		(function($, doc, $$, undefined) {
			$$.init();
			var _self;
			if (window.plus) {
				plusReady();
			} else {
				doc.addEventListener('plusready', plusReady, false);
			}

			function plusReady() {
				plus.navigator.setFullscreen(false);
				//强制竖屏
				plus.screen.lockOrientation("portrait-primary");
				//强制隐藏滚动条
				plus.webview.currentWebview().setStyle({
					scrollIndicator: 'none'
				});
				_self = plus.webview.currentWebview();
				// 获取地址列表
				// var getUserAddressWati = plus.nativeUI.showWaiting("获取中...");
				getUserAddress(mui, plus.storage.getItem('memberId'), function(data) {
					// getUserAddressWati().close()
					if (data.code == 200) {
						if (data.data.length == 10) {
							$('.bottom_btn').css('display', 'none')
						}
						list = $('#myAddress');
						data.data.forEach(e => {
							if (e.isDefault == 1) {
								$(
									'<div class="address_moduel">' +
									'<div class="_left">' +
									'<div class="_one">' +
									'<span style="color: #5A5A5A;">' + e.receiver + '</span>' +
									'<span>' + e.mobile + '</span>' +
									'<span class="_falge">默认</span>' +
									'</div>' +
									'<div class="_two">' +
									e.province + e.city + e.area + e.address +
									'</div>' +
									'</div>' +
									'<div class="_three"></div>' +
									'<div class="_right" id="goToEdit"  data-id="' + e.id + '">编辑</div>' +
									'</div>'
								).appendTo(list)
							} else {
								$(
									'<div class="address_moduel">' +
									'<div class="_left">' +
									'<div class="_one">' +
									'<span style="color: #5A5A5A;">' + e.receiver + '</span>' +
									'<span>' + e.mobile + '</span>' +
									'</div>' +
									'<div class="_two">' +
									e.province + e.city + e.area + e.address +
									'</div>' +
									'</div>' +
									'<div class="_three"></div>' +
									'<div class="_right" id="goToEdit"  data-id="' + e.id + '">编辑</div>' +
									'</div>'
								).appendTo(list)
							}

						});
					} else if (data.code == 401 || data.code == 1500) {
						gotoLoginIn()
					} else {
						tipShow(data.message)
					}
				});
			}

			// 去编辑地址
			$('.bottom_btn').on('tap', function() {
				$$.openWindow({
					url: 'addressEditor.html',
					id: 'addressEditor',
					extras: {
						"orderId": '3243242'
					},
					show: {
						aniShow: "slide-in-right"
					}
				});
			})
			// 新增地址
			$('#myAddress').on('tap', '#goToEdit', function() {
				$$.openWindow({
					url: 'addressEditor.html',
					id: 'addressEditor',
					extras: {
						"addressId": $(this).attr('data-id')
					},
					show: {
						aniShow: "slide-in-right"
					}
				});
			})

		})(jQuery, document, mui);
	</script>

</html>
