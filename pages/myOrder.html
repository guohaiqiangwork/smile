<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>my_setting</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../css/mui.min.css">
		<link rel="stylesheet" href="../css/common.css">
		<script src="../js/rem_reset.js"></script>
		<link rel="stylesheet" type="text/css" href="../css/common.css" />
		<link rel="stylesheet" type="text/css" href="../css/pages/order.css" />
	</head>
	<body onselectstart="return false;">
		<header class="header_white title">
			<i class="mui-action-back"><img src="../image/left@2x.png"></i>
			我的订单
		</header>
		<div class="content">
			<!-- 列表部分 -->
			<div id="titleList">
				<div style="touch-action: none;" id="segmentedControl" class="mui-segmented-control mui-segmented-control-inverted">
					<a class="mui-control-item mui-active ">全部</a>
					<a class="mui-control-item">待付款</a>
					<a class="mui-control-item">待发货</a>
					<a class="mui-control-item ">待收货</a>
				</div>
			</div>

			<div>
				<div>
					<div class="product_moudel">
						<!-- 标题 -->
						<div class="div_display product_border">
							<div class=" product_moudel_title">
								<img src="../image/mu.jpg" style="width: 100%;">
							</div>
							<div class="font_colorc1 font_size28" style="margin-top: .3rem;margin-left: .2rem;">
								笑容
							</div>
							<div class="deleteOrder">
								删除
							</div>
						</div>
						<!--  多个产品 -->
						<div class="div_display" style="display: none;">
							<div class="product_imgList_left div_display">
								<div>
									<div class="product_number">
										33+
									</div>
									<div class="product_img_w ">
										<img src="../image/mu.jpg" style="width: 100%;height: 100%;">
									</div>
									<div class=" img_w_m font_color66 font_size22 ">
										¥25.00
									</div>
								</div>
							</div>
							<div class="product_imgList_right font_size24 font_color33 goToCommodities">
								共9种
								<i class="fa fa-angle-right  font_colorcb" style="font-size: .32rem;margin-left: .03rem;"></i>
							</div>
						</div>
						<!-- 单个产品 -->
						<div class="div_display" id="bodyList">
							<div class="product_imgList_leftd">
								<div class="product_img_wd ">
									<img src="../image/mu.jpg" style="width: 100%;height: 100%;">
								</div>
							</div>
							<div class="product_imgList_rightd">
								<div class="font_size26 font_color33">
									每日维C-奇异果口味
								</div>
								<div class="font_size26 font_color99">
									规格: 450g/袋
								</div>
								<div class="font_size26 font_colorf4">
									¥45.90
								</div>
							</div>
							<div class="product_rightd_number font_size28 font_color99">
								*2
							</div>
						</div>
					
					</div>
					<!-- <ul id="bodyList_ul">
					
					</ul> -->
				</div>
			</div>

			<!-- 删除提示框 -->
			<div id="orderChange" style="display: none;" class="order_change_model">
				<div class="orderChange_moudel">
					<div class="font_size32 font_color33" style="margin-top: .3rem;">
						确定删除此订单？
					</div>
					<div class="font_size24 font_size24" style="margin-top: .4rem;">
						删除后如有售后问题可联系客服恢复
					</div>
				</div>
				<div class="orderChange_moudel_btn div_display">
					<div class="moudel-close">
						取消
					</div>
					<div class="font_colorff div_backgroun_jb" style="border: none;">
						确定
					</div>
				</div>
			</div>
		</div>


	</body>
	<script src="../js/jquery-1.11.2.min.js"></script>
	<script src="../js/mui.min.js"></script>
	<script src="../js/commonFun.js"></script>
	<script src="../js/requestFun.js"></script>
	<script>
		(function($, doc, $$, undefined) {
			$$.init({
				swipeBack: true //启用右滑关闭功能
			});
			var _self;
			if (window.plus) {
				plusReady();
			} else {
				doc.addEventListener('plusready', plusReady, false);
			}

			function plusReady() {
				plus.navigator.setFullscreen(false);
				//强制竖屏
				plus.screen.lockOrientation("portrait-primary");
				//强制隐藏滚动条
				plus.webview.currentWebview().setStyle({
					scrollIndicator: 'none'
				});
				_self = plus.webview.currentWebview();
				/* 默认查询全部流水 */
				var dataBase = {
					memberId: plus.storage.getItem('memberId'),
					transType: ''
				};
				fallBankMassage(mui, dataBase, function(data) {
					if (data.code == 200) {
						listHtml(data.data.data);
					} else {
						tipShow(data.message);
					}
				})
			}

			//遮罩
			var orderChange = mui.createMask(function() {
				$(".order_change_model").css("display", "none");
				return;
			});
			//去支付
			$('.deleteOrder').on('tap', function() {
				// 显示提示
				orderChange.show();
				$(".order_change_model").css("display", "block");
			})
			// 关闭
			$("#orderChange .moudel-close").on("tap", function() {
				$(".order_change_model").css("display", "none");
				orderChange.close();
			});
			// 跳转详情页面
			$('#bodyList').on('tap', function() {
				$$.openWindow({
					url: '../pages/orderDetails.html',
					id: 'orderDetails',
					show: {
						aniShow: "slide-in-right"
					}
				});
			})


			/* 选项卡点击事件 */
			mui("#segmentedControl").on('tap', '.mui-control-item', function(event) {
				var info = $(this).html();
				console.log("我是点击的选项卡" + info)
				var dataBase = {};
				if (info == "全部") {
					dataBase = {
						memberId: plus.storage.getItem('memberId'),
						transType: ''
					};
				} else if (info == "支出") {
					dataBase = {
						memberId: plus.storage.getItem('memberId'),
						transType: 2
					};
				} else if (info == "收入") {
					dataBase = {
						memberId: plus.storage.getItem('memberId'),
						transType: 1
					};
				}
				/* 请求接口 */
				fallBankMassage(mui, dataBase, function(data) {
					if (data.code == 200) {
						listHtml(data.data.data);
					} else {
						tipShow(data.message);
					}
				})
			});


			/** list 循环公共方法
			 *
			 * data ：后台返回数据
			 * 
			 */
			function listHtml(data) {
				var bodyList_ul = doc.getElementById("bodyList_ul");
				var html = [];
				var mark = "";
				for (i = 0; i < data.length; i++) {
					if (data[i].recordDesc == "收入") {
						mark = "+ ";
					} else {
						mark = "- ";
					}
					html.push('<li><div>' + data[i].recordDesc + '</div><div>' + data[i].createTime + '</div><div>' + mark + data[i].amount +
						'</div></li>');
				}
				bodyList_ul.innerHTML = html.join('');
			}



		})(jQuery, document, mui);
	</script>

</html>
