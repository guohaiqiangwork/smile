<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>购物车</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<link rel="stylesheet" href="../css/font-awesome.min.css">
		<link rel="stylesheet" href="../css/mui.min.css">
		<link rel="stylesheet" href="../css/common.css">
		<link rel="stylesheet" href="../css/mobileReset.css">
		<link rel="stylesheet" href="../css/pages/shopCart.css" />

		<style>
			.mui-numbox {
			    position: relative;
			    display: inline-block;
			    overflow: hidden;
			    width: 2.5rem;
			    height: .45rem;
			    padding: 0 !important;
			    vertical-align: top;
			    vertical-align: middle;
			    border: none!important; 
			    border-radius: 3px;
			    -background-color: #F4F4F4;
			}
			
			html {
			    background: 0;
			}

			.mui-checkbox input[type=checkbox]:checked:before {
				background: linear-gradient(to right, #FF342D, #FF5882);
				-webkit-background-clip: text;
				color: transparent;
			}
		</style>
		<script src="../js/rem_reset.js"></script>
	</head>
	<body onselectstart="return false;" style="background-color: #FAFAFA;">
		<header class="header_white" style="background-color: #FFFFFF;"> 
			<div class="div_display" style="background-color: #FFFFFF;">
				<div class="font_size36 font_color99" style="margin-left: 3rem;">
					购物车
				</div>
				<div class="font_size30 font_color08 bianji" style="margin-left: 2.5rem;">
					编辑
				</div>
			</div>
		</header>
		<div style="background-color: ;">
			<!-- 商品块 -->
			<div id="shopList" style="padding-top: 0.8rem;">
				
			</div>

			<!-- 失效商品 -->
			<div class="nvalid" style="display: none;">
				<div>失效</div>
				<div>失效商品</div>
			</div>
			
			<div class="shopListTwo" style="margin-bottom: 1.5rem;">
				
			</div>

			<!-- 缺省页 -->
			<div id="cartDefaultId" style="display: none;">
				<div id="cartDefaultId_one">
					<img src="../image/default/shopCar.png" >
				</div>
				<div id="cartDefaultId_two">
					<span>您的购物车还是空的哦 ~</span>
				</div>
				<div id="cartDefaultId_shree">
					<div class="pay_go_index div_backgroun_jb gotoHomePage">
						去首页逛逛
					</div>
				</div>
			</div>

			<!-- 底部操作栏结算 -->
			<div class="div_display bootom_title gontoSettlement bootomDiv" style="display: none;">
				<div class="bootom_left">
					<div class="mui-input-row mui-checkbox mui-left">
						<label>全选</label>
						<input id="checkboxAll" value="Item 2" type="checkbox">
					</div>
				</div>
				<div class="bootom_price">
					合计：<span class="bootom_price_font"> ¥ <span class="totalPrice">0.00</span> </span>
					<div style="color: #999999;font-size: .18rem;margin-left: 1rem;">
						（含运费）
					</div>
				</div>
				<div class="bootom_right">
					<div class="bootom_right_width">去结算
						<span class="totalNumF" style="display:none"> <span>（</span><span class="totalNum">0</span> <span>）</span></span>
					</div>
				</div>
			</div>

			<!-- 编辑 -->
			<div class="div_display bootom_title gontoSettlementEdit" style="display: none;">
				<div class="bootom_left">
					<div class="mui-input-row mui-checkbox mui-left">
						<label>全选</label>
						<input id="checkboxAll2" name="checkbox2" value="Item 2" type="checkbox">
					</div>
				</div>

				<div class="bootom_editor bootom_editor_border qxcz" style="margin-left: 1.5rem;">
					取消操作
				</div>
				<div class="bootom_editor bootom_editor_border1 confirmSelect">
					确认删除
				</div>
			</div>

		</div>
	</body>
	<script src="../js/jquery-1.11.2.min.js"></script>
	<script src="../js/mui.min.js"></script>
	<script src="../js/commonFun.js"></script>
	<script src="../js/requestFun.js"></script>
	<script>
		(function($, doc, $$) {
			$$.init();
			var _self;
			if (window.plus) {
				plusReady();
			} else {
				doc.addEventListener('plusready', plusReady, false);
			}
			
			var effectiveList_num = "";
			var no_effectiveList_num = "";
			function plusReady() {
				plus.navigator.setFullscreen(false);
				//强制竖屏
				plus.screen.lockOrientation("portrait-primary");
				//强制隐藏滚动条
				plus.webview.currentWebview().setStyle({
					scrollIndicator: 'none'
				});
				
				_self = plus.webview.currentWebview();
				
				//监听支付页物理返回键返回到购物车事件
				window.addEventListener('shopCartEvent', function(e) {
					var pagePara  = e.detail.pagePara;
					//alert("监听支付页物理返回键返回到购物车事件="+ pagePara);
					if(pagePara == "gotoOrder"){
						$$.openWindow({
							url: '../pages/myOrder.html',
							id: 'myOrder',
							extras: {
								orderType: "1"
							},
							show: {
								aniShow: "slide-in-right"
							}
						});
					}
				});
				
				/* 监听首页返回刷新页面 */
				window.addEventListener('refreshMajorGuestCount', function(e) {
					effectiveList(function(data){
						sign("eff",data);
					});
					no_effectiveList(function(data){
						sign("no_eff",data);
					});
					
					/* 全选按钮取消红点 */
					$("#checkboxAll").prop("checked", false);
					
					/*合计和总数量赋值 0 */
					$(".totalNum").text(0);
					$(".totalPrice").text(0);
				});
				
				/* 监听子页面返回刷新页面 */
				window.addEventListener('returnFunc', function(e) {
					effectiveList(function(data){
						sign("eff",data);
					});
					no_effectiveList(function(data){
						sign("no_eff",data);
					});
					
					/* 全选按钮取消红点 */
					$("#checkboxAll").prop("checked", false);
					
					/*合计和总数量赋值 0 */
					$(".totalNum").text(0);
					$(".totalPrice").text(0);
				});
				
				effectiveList(function(data){
					sign("eff",data);
				});
				no_effectiveList(function(data){
					sign("no_eff",data);
				});
				
				function sign(name,doublePar){
					if(name == "eff"){
						effectiveList_num = doublePar;
					}
					if(name == "no_eff"){
						no_effectiveList_num = doublePar;
					}
					
					if(effectiveList_num && no_effectiveList_num){
						$("#cartDefaultId").css("display", "block");
						$(".bootomDiv").css("display", "none");
						$(".bianji").css("display", "none");
					}else{
						$(".bianji").css("display", "block");
						$("#cartDefaultId").css("display", "none");
						$(".bootomDiv").css("display", "block");
					}
				};
				
				// 去首页
				$('.gotoHomePage').on('tap',function(){
					toIndex(0);
				});
				
				//请求购物车列表数据  有效
				function effectiveList(callback){
					cartList(mui,plus.storage.getItem('memberId'),function(data){
						if (data.code == 200) {
							var keywordData = data.data;
							if(keywordData.length == 0){
								/* 删除子标签 */
								$('#shopList').empty();
								callback(true);
							}else{ 
								var fragmentplanList = document.createDocumentFragment();
								for(i=0;i<keywordData.length;i++){
									var orderLi =
										'<div cartData=' + JSON.stringify(keywordData[i])  + ' cartData_id=' + keywordData[i].id + ' class="shopCart_moudel div_display">' +
										'<div class="shopCart_moudel_left">' +
										'<div class="mui-checkbox">' +
										'<input data-Params="0" name="commodity"'+
										' type="checkbox" class="res" data-price=' + keywordData[i].price + ' data-index=' + [i] +
										' style="margin-top: 0.8rem;padding-left: .3rem;">' +
										'</div>' +
										'</div>' +
										'<div class="shopCart_moudel_right">' +
										'<div class="div_display">' +
										
										'<div class="shopCart_img">' +
										'<img src="' + keywordData[i].picture + '" class="shopCart_img_width">' +
										'</div>' +
										 
										'<div class="shopCart_product">' +
										'<div class="shopCart_product_title">' +
										keywordData[i].goodsName +
										'</div>' +
										'<div class="shopCart_product_g">' +
										keywordData[i].pecificationName +
										'</div>' +
										'<div class="shopCart_price">￥' +
										keywordData[i].price +
										'</div>' +
										'<div class="shopCart_number" id="data ' + i + ' ">' +
										'<div class="mui-numbox num-btn" data-numbox-step="1" data-numbox-min="1" data-numbox-max="99" id="box ' +
										i + '" >' +
										//"-"按钮，点击可减小当前数值																		
										'<button id="minusId" class="mui-btn mui-numbox-btn-minus" type="button" data-price=' + keywordData[i].price +
										' >-</button>' +
										'<input onfocus="this.blur();" readonly="readonly" cartData_id=' + keywordData[i].id + ' cartData_pecificationId=' + keywordData[i].pecificationId + ' data-num=' + keywordData[i].num + ' class="mui-numbox-input" type="number" value="' + keywordData[i].num +
										'" />' +
										//"+"按钮，点击可增大当前数值
										'<button id="addId" class="mui-btn mui-numbox-btn-plus" type="button" data-price=' + keywordData[i].price +
										'>+</button>' +
										'</div>' +
										'</div>' +
										'</div>' +
										'</div>' +
										'</div>' +
										'</div>';
									$(fragmentplanList).append(orderLi);
								}
								/* 删除子标签 */
								$('#shopList').empty();
								$("#shopList").append($(fragmentplanList));
								
								callback(false);
							}
						} else {
							tipShow(data.message);
						}
					});
				};
				
				/* 失效 */
				function no_effectiveList(callback){
					cartListNo(mui, plus.storage.getItem('memberId'), function(data) {
						if (data.code == 200) {
							//console.log("2342---==="+JSON.stringify(data))
							var fragmentplanListTwo = document.createDocumentFragment();
							var keywordDataTwo = data.data;
							if(keywordDataTwo.length == 0){
								/* 删除子标签 */
								$('.shopListTwo').empty();
								$(".nvalid").css("display", "none");
								callback(true);
							}else{
								$(".nvalid").css("display", "block");
								
								$.each(keywordDataTwo, function(index) {
									var orderLi ='<div cartDataNo_id='+keywordDataTwo[index].id +
										' class="shopCart_moudel div_display wxList" style="margin-top: .2rem;">' +
										'<div class="shopCart_moudel_left">' +
										'<div class="shopCart_Invalid" style="margin-top: 1rem;margin-left: .05rem;">失效' +
										'</div>' +
										//失效商品选中圆圈
										'<div class="mui-checkbox sxyq">' +
										'<input data-Params="0" name="commodityTwo" type="checkbox" class="res" style="margin-top: 1rem;padding-left: .2rem;">' +
										'</div>' +
										
										'</div>' +
										'<div class="shopCart_moudel_right">' +
										'<div class="div_display">' +
										'<div class="shopCart_img">' +
										'<img src="'+keywordDataTwo[index].picture +'" class="shopCart_img_width">' +
										'</div>' +
										'<div class="shopCart_product font_color99 font_size28">' +
										'<div class="shopCart_product_title">'+keywordDataTwo[index].goodsName +
										'</div>' +
										'<div class="shopCart_product_g">'+keywordDataTwo[index].pecificationName +
										'</div>' +
										'<div class="font_size32 font_color33 margin_top2">不好意思，该商品已售罄' +
										'</div>' +
										'</div>' +
										'</div>' +
										'</div>' +
										'</div>';
									
									$(fragmentplanListTwo).append(orderLi);
								});
								$('.shopListTwo').empty();
								$(".shopListTwo").append($(fragmentplanListTwo));
								
								callback(false);
							}
						} else {
							tipShow(data.message);
						}
					});
				}
				
				/* 编辑点击事件 */
				$(".font_color08").on("tap",function(){
					var edit = $(".font_color08").text().replace(/\s*/g,"");
					if(edit == "编辑"){
						$(".font_color08").text("完成");
						$(".shopCart_Invalid").css("display", "none");
						$(".sxyq").css("display", "block");
						
						$(".gontoSettlement").css("display", "none");
						$(".gontoSettlementEdit").css("display", "");
					}else{
						$(".font_color08").text("编辑");
						$(".sxyq").css("display", "none");
						$(".shopCart_Invalid").css("display", "block");
						
						$(".gontoSettlementEdit").css("display", "none");
						$(".gontoSettlement").css("display", "");
					}
				});
				
				/* 取消操作 */
				$(".qxcz").on("tap",function(){
					$(".font_color08").text("编辑");
					$(".sxyq").css("display", "none");
					$(".shopCart_Invalid").css("display", "block");
					
					$(".gontoSettlementEdit").css("display", "none");
					$(".gontoSettlement").css("display", "");
				});
				
				/* 确认删除 */
				$(".confirmSelect").on("tap",function(){
					var array = [];
					
					/* 有效 */
					$('#shopList .shopCart_moudel').each(function(index) {
						if($(this).children(".shopCart_moudel_left").find("input").attr("data-Params") == "1"){
							array.push($(this).attr('cartData_id'));
						}
					});
					/* 有效商品删除后，合计和总数量赋值 0 */
					$(".totalNum").text(0);
					$(".totalPrice").text(0);
					
					
					/* 无效 */
					$('.shopListTwo .wxList').each(function() {
						if($(this).find("input").attr("data-Params") == "1"){
							array.push($(this).attr('cartDataNo_id'));
						}
					});
					
					if(array.length == 0){
						tipShow("请选中需要删除的商品");
					}else{
						delCarts(mui, array, function(data) {
							if (data.code == 200) {
								effectiveList(function(data){
									sign("eff",data);
								});
								no_effectiveList(function(data){
									sign("no_eff",data);
								});
								
								$(".font_color08").text("编辑");
								$(".sxyq").css("display", "none");
								$(".shopCart_Invalid").css("display", "block");
								
								$(".gontoSettlementEdit").css("display", "none");
								$(".gontoSettlement").css("display", "");
								
								tipShow("删除成功");
								
								/* 全选按钮取消红点 */
								$("#checkboxAll").prop("checked", false);
							} else {
								tipShow(data.message);
							}
						});
					}
				});
				
				/* 失效商品 圆圈点击事件 */
				var $checkboxTwo = $("input[name='commodityTwo']");
				$(".shopListTwo").on("tap","input[name='commodityTwo']",function(){
					var dataParams = $(this).attr("data-Params");
					if(dataParams == 0){
						$(this).attr("data-Params",1);
					}else{
						$(this).attr("data-Params",0);
					}
					
					if($checkboxTwo.length == $("input[name='commodityTwo']:checked").length){
						$("#checkboxAll").prop("checked", $checkboxTwo.length == $("input[name='commodityTwo']:checked").length ? true :
							false);
					}else{
						if(dataParams == 0 && $(".shopListTwo input[name='commodityTwo']:checked").length == 1){
							//如果取消最后一个选中,取消总选项
							$("#checkboxAll").prop("checked", false);
						}else{
							$("#checkboxAll").prop("checked", $("input[name='commodityTwo']:checked").length > 0 ? true :
								false);
						}
					}
				});
				
				// 获取复选框的value 值
				function getRadioRes(className) {
					var rdsObj = document.getElementsByClassName(className);
					var checkVal = new Array();
					var k = 0;
					for (i = 0; i < rdsObj.length; i++) {
						if (rdsObj[i].checked) {
							checkVal[k] = rdsObj[i].value;
							k++;
						}
					}
					return checkVal;
				};
				
				// 全选 (只是 有效商品)
				$("#checkboxAll").click(function() {
					var num = 0;
					var prices = 0;
					$('input[name="commodity"]').prop("checked", this.checked);
					
					/* 查看总选项是否选中 false:取消*/
					var checkboxAll = $("#checkboxAll").prop("checked");
					//有效
					if(!checkboxAll){
						/* 已选中 */
						$('#shopList .shopCart_moudel').each(function(index) {
							if($(this).children(".shopCart_moudel_left").find("input").attr("data-Params") == "1"){
								$(this).children(".shopCart_moudel_left").find("input").attr("data-Params","0");
							}
						});
						/* 算总金额，总数量，并赋值 */
						$(".totalNum").text("0"); 
						$('.totalNumF').show();
						$(".totalPrice").text("0");
					}else{
						/* 未选中 */
						$('#shopList .shopCart_moudel').each(function(index) {
							if($(this).children(".shopCart_moudel_left").find("input").attr("data-Params") == "0"){
								$(this).children(".shopCart_moudel_left").find("input").attr("data-Params","1");
								
								var rowNum = $(this).children(".shopCart_moudel_right").find("input").attr("data-num");
								var cartDataJson = eval('(' + $(this).attr('cartData') + ')');
								num = (num - 0) + (rowNum - 0);
								var totleMoney = (cartDataJson.price - 0) * (rowNum - 0);
								prices = (prices - 0) +  (totleMoney.toFixed(2) - 0);
							}
						});
						var danPrice = $(".totalPrice").text();
						/* 算总金额，总数量，并赋值 */
						$(".totalNum").text(num + ($(".totalNum").text() - 0));
						$('.totalNumF').show();
						var totalPriceTwo = prices + (danPrice - 0);
						$(".totalPrice").text(totalPriceTwo.toFixed(2));
					}
					
					
					/* 无效 */
					$('.shopListTwo .wxList').each(function() {
						if($(this).find("input").attr("data-Params") == "1"){
							$(this).find("input").attr("data-Params","0");
						}else{
							$(this).find("input").attr("data-Params","1");
						}
					});
				});
				
				
				// 全选 +失效商品
				$("#checkboxAll2").click(function() {
					$('input[name="commodity"]').prop("checked", this.checked);
					$('input[name="commodityTwo"]').prop("checked", this.checked);
					
					/* 查看总选项是否选中 false:取消*/
					var checkboxAll = $("#checkboxAll").prop("checked");
					
					if(checkboxAll){
						$('#shopList .shopCart_moudel').each(function(index) {
							$(this).children(".shopCart_moudel_left").find("input").attr("data-Params","0");
						});
					}else{
						$('#shopList .shopCart_moudel').each(function(index) {
							$(this).children(".shopCart_moudel_left").find("input").attr("data-Params","1");
						});
					}
					
					/* 无效 */
					$('.shopListTwo .wxList').each(function() {
						if($(this).find("input").attr("data-Params") == "1"){
							$(this).find("input").attr("data-Params","0");
						}else{
							$(this).find("input").attr("data-Params","1");
						}
					});
				});
				
				// 单选input[name='commodity']-----有效
				var $checkbox = $("input[name='commodity']");
				mui("#shopList").on('change', 'input', function() {
					//合计处的数量
					var totalNum = parseInt($(".totalNum").text());
					/* 从红点选项找到现在的商品数量--选中行数量 */
					var redCircle = $(this).parent().parent().next().find("input").attr("data-num");
					/**
					 * 0：未选中
					 * 1：选中 
					 * **/
					var dataParams = $(this).attr("data-Params");
					
					//计算金额
					var totalPrice = $(".totalPrice").text();
					var danPrice = $(this).parent().parent().next().find(".shopCart_price").text();
					danPrice = danPrice.replace("￥","");
					if(dataParams == 0){
						//如果是选中  添加数量
						$(".totalNum").text(Number(totalNum) + Number(redCircle));
						$('.totalNumF').show();
						//合计金额
						var totleOne = (Number(redCircle) * Number(danPrice)).toFixed(2);
						$(".totalPrice").text(((totalPrice - 0) + (totleOne- 0)).toFixed(2));

						$(this).attr("data-Params",1);
					}else{
						//子取消一个,总的就取消
						$("#checkboxAll").prop("checked", false);
						//如果是取消选中
						$(".totalNum").text((totalNum - 0) - (redCircle- 0));
						//合计金额
						var totleOne = ((redCircle - 0) * (danPrice - 0)).toFixed(2);
						$(".totalPrice").text(((totalPrice - 0) - (totleOne- 0)).toFixed(2));
						
						$(this).attr("data-Params",0);
					}
					
					
					/* 下面部分为 有效商品圆圈选中和底部导航全选联动 */
					/* if($checkbox.length == $("input[name='commodity']:checked").length){
						$("#checkboxAll").prop("checked", $checkbox.length == $("input[name='commodity']:checked").length ? true :
							false);
					}else{
						if(dataParams != 0 && $("#shopList input[name='commodity']:checked").length == 1){
							//如果取消最后一个选中,取消总选项
							$("#checkboxAll").prop("checked", false);
						}else{
							$("#checkboxAll").prop("checked", $("input[name='commodity']:checked").length > 0 ? true :
								false);
						}
					} */
					
				});
				$checkbox.click(function() {
					alert($(this).attr("data-price"));
					$("#checkboxAll").prop("checked", $checkbox.length == $("input[name='commodity']:checked").length ? true :
						false);
				});
				// mui组件 监听加减
/* 				mui('.mui-numbox').on('tap', '.mui-numbox-btn-minus', function() {
					alert($(this).attr("data-price"));
					alert($(this).attr("data-number"));
				});
				mui('.mui-numbox').on('tap', '.mui-numbox-btn-plus', function() {
					alert("222");
					alert($(this).attr("data-price"));
				}); */
				
				/* 购物车数量 加 事件*/
				$("#shopList").on("tap",".mui-numbox-btn-plus",function(){
					$("#addId").attr('disabled',true);
					var num = $(this).parent().children("input");
					//当前行是否选中
					var dataParams = $(this).parents(".shopCart_moudel_right").siblings(".shopCart_moudel_left").find("input").attr("data-Params");
					//单价
					var danPrice = $(this).parent().parent().prev(".shopCart_price").text();
					
					var me = this;
					/* 把数量传给后端 */
					var cartdataBase = {
						id: $(me).prev().attr("cartData_id"),
						num: parseInt(num.val()) + 1,
						pecificationId: $(me).prev().attr("cartData_pecificationId"),
					};
					setCarttNum(mui, cartdataBase, function(data) {
						if (data.code == 200) {
							num.val(data.data);/* parseInt(num.val()) + 1 */
							$(me).prev().attr("data-num", data.data);/* parseInt($(me).prev().attr("data-num")) + 1 */
							/**当前行是否选中，处理结算处数量
							 * 0：未选中
							 * 1：选中
							 * **/
							if(dataParams == 1){
								var totalNum = parseInt($(".totalNum").text()) + 1;
								$(".totalNum").text(totalNum);
								
								//合计金额
								var totalPrice = $(".totalPrice").text();
								danPrice = danPrice.replace("￥","");
								if(Number(totalPrice) != 0){
									$(".totalPrice").text(((totalPrice - 0) + (danPrice - 0)).toFixed(2));
								}
							}
							$("#addId").attr('disabled',false);
						} else {
							params_one = "0";
							tipShow(data.message);
						}
					});
				})

				/* 购物车数量 减 事件*/
				$("#shopList").on("tap",".mui-numbox-btn-minus",function(){
					$("#minusId").attr('disabled',true);
					var num = $(this).parent().children("input");
					var me = this;
					if (parseInt(num.val()) > 1) {
						/* 把数量传给后端 */
						var cartdataBase = {
							id: $(this).next().attr("cartData_id"),
							num: parseInt(num.val())-1,
							pecificationId: $(this).next().attr("cartData_pecificationId"),
						};
						setCarttNum(mui, cartdataBase, function(data) {
							if (data.code == 200) {
								num.val(data.data);/* parseInt(num.val()) - 1 */
								$(me).next().attr("data-num", data.data);/* parseInt($(me).next().attr("data-num")) - 1 */
								
								/**当前行是否选中，处理结算处数量
								 * 0：未选中
								 * 1：选中
								 * **/
								 var totalPrice = $(".totalPrice").text();
								 var danPrice = $(me).parent().parent().prev(".shopCart_price").text();
								 var dataParams = $(me).parents(".shopCart_moudel_right").siblings(".shopCart_moudel_left").find("input").attr("data-Params");
								if(dataParams == 1){
									console.log("dataParams="+dataParams);
									var totalNum = parseInt($(".totalNum").text()) - 1;
									$(".totalNum").text(totalNum);
									
									//合计金额
									danPrice = danPrice.replace("￥","");
									if(Number(totalPrice) != 0){
										$(".totalPrice").text(((totalPrice - 0) - Number(danPrice - 0)).toFixed(2));
									}
								}
								$("#minusId").attr('disabled',false);
							} else {
								tipShow(data.message);
							}
						});
					} else {
						tipShow("最少需要1件商品哦");
					}
				})

				// 去订单确认  去结算按钮
				$('.bootom_right_width').on('tap', function() {
					/* 有效 */
					var array = [];
					var cartId = [];
					$('#shopList .shopCart_moudel').each(function(index) {
						if($(this).children(".shopCart_moudel_left").find("input").attr("data-Params") == "1"){
							var cartDataJson = eval('(' + $(this).attr('cartData') + ')');
							var obj={};
							obj.goodsId = cartDataJson.goodsId;
							obj.num = $(this).children(".shopCart_moudel_right").find("input").attr("data-num");
							obj.skuId = cartDataJson.pecificationId;
							array.push(obj);
							
							/* 收集购物车id */
							cartId.push(cartDataJson.id);
						}
					});
					var dataBassJSO = JSON.stringify(array);
					cartId = JSON.stringify(cartId);
					if(array.length == 0){
						tipShow("请选择商品");
					}else{
						
						$$.openWindow({
							url: '../pages/confirmOrder.html',
							id: 'confirmOrder',
							extras: {
								dataBassJSO: dataBassJSO,
								cartId:cartId
							},
							show: {
								aniShow: "slide-in-right"
							}
						});
					};
				});
			};
		})(jQuery, document, mui);
	</script>

</html>
